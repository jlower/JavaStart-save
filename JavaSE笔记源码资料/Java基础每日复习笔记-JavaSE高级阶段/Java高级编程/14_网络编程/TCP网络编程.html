<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>TCPÍøÂç±à³Ì.html</title>
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
  margin: 15px 23px 15px 23px;
  background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 9pt;
 font-family: 'ËÎÌå';
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
a.rvts1, span.rvts1 /* Hyperlink */
{
 color: #0000ff;
 text-decoration: underline;
}
span.rvts2
{
 font-size: 15pt;
 font-family: 'Consolas';
 color: #000000;
}
span.rvts3
{
 font-size: 15pt;
 font-family: '??';
 font-style: italic;
 color: #008017;
}
span.rvts4
{
 font-size: 15pt;
 font-family: 'Consolas';
 font-style: italic;
 color: #008017;
}
span.rvts5
{
 font-size: 15pt;
 font-family: 'Consolas';
 color: #808000;
}
span.rvts6
{
 font-size: 15pt;
 font-family: 'Consolas';
 font-weight: bold;
 color: #000080;
}
span.rvts7
{
 font-size: 15pt;
 font-family: 'Consolas';
 font-style: italic;
 color: #000000;
}
span.rvts8
{
 font-size: 15pt;
 font-family: 'Consolas';
 font-weight: bold;
 color: #008000;
}
span.rvts9
{
 font-size: 15pt;
 font-family: 'Consolas';
 color: #0000ff;
}
span.rvts10
{
 font-size: 15pt;
 font-family: '??';
 font-weight: bold;
 color: #008000;
}
span.rvts11
{
 font-size: 15pt;
 font-family: 'Consolas';
 font-style: italic;
 font-weight: bold;
 color: #660e7a;
}
span.rvts12
{
 font-size: 15pt;
 font-family: 'Consolas';
 color: #000000;
 background-color: #ffff00;
}
span.rvts13
{
 font-size: 12pt;
 font-weight: bold;
 color: #000000;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
.rvps2
{
 background: #ffffff;
}
/* ========== Lists ========== */
.list0 {text-indent: 0px; margin-left: 0px; list-style-position: outside; list-style-type: disc;}
--></style>
</head>
<body>
<p class=rvps1><span class=rvts13>TCP&#32593;&#32476;&#32534;&#31243;</span></p>
<p><span class=rvts13><br></span></p>
<p><span class=rvts2>&#20195;&#30721;&#31034;&#20363;1&#65306;</span><span class=rvts3>&#23458;&#25143;&#31471;&#21457;&#36865;&#20449;&#24687;&#32473;&#26381;&#21153;&#31471;&#65292;&#26381;&#21153;&#31471;&#23558;&#25968;&#25454;&#26174;&#31034;&#22312;&#25511;&#21046;&#21488;&#19978;</span></p>
<p class=rvps2><span class=rvts4>//</span><span class=rvts3>&#23458;&#25143;&#31471;</span><br><span class=rvts3> &nbsp; &nbsp;</span><span class=rvts5>@Test</span><br><span class=rvts5> &nbsp; &nbsp;</span><span class=rvts6>public void </span><span class=rvts2>client() &nbsp;{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;Socket socket = </span><span class=rvts6>null</span><span class=rvts2>;</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;OutputStream os = </span><span class=rvts6>null</span><span class=rvts2>;</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>try </span><span class=rvts2>{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts4>//1.</span><span class=rvts3>&#21019;&#24314;</span><span class=rvts4>Socket</span><span class=rvts3>&#23545;&#35937;&#65292;&#25351;&#26126;&#26381;&#21153;&#22120;&#31471;&#30340;</span><span class=rvts4>ip</span><span class=rvts3>&#21644;&#31471;&#21475;&#21495;</span><br><span class=rvts3> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>InetAddress inet = InetAddress.</span><span class=rvts7>getByName</span><span class=rvts2>(</span><span class=rvts8>"192.168.14.100"</span><span class=rvts2>);</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;socket = </span><span class=rvts6>new </span><span class=rvts2>Socket(inet,</span><span class=rvts9>8899</span><span class=rvts2>);</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts4>//2.</span><span class=rvts3>&#33719;&#21462;&#19968;&#20010;&#36755;&#20986;&#27969;&#65292;&#29992;&#20110;&#36755;&#20986;&#25968;&#25454;</span><br><span class=rvts3> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>os = socket.getOutputStream();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts4>//3.</span><span class=rvts3>&#20889;&#20986;&#25968;&#25454;&#30340;&#25805;&#20316;</span><br><span class=rvts3> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>os.write(</span><span class=rvts8>"</span><span class=rvts10>&#20320;&#22909;&#65292;&#25105;&#26159;&#23458;&#25143;&#31471;</span><span class=rvts8>mm"</span><span class=rvts2>.getBytes());</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class=rvts6>catch </span><span class=rvts2>(IOException e) {</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.printStackTrace();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class=rvts6>finally </span><span class=rvts2>{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts4>//4.</span><span class=rvts3>&#36164;&#28304;&#30340;&#20851;&#38381;</span><br><span class=rvts3> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>if</span><span class=rvts2>(os != </span><span class=rvts6>null</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>try </span><span class=rvts2>{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.close();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class=rvts6>catch </span><span class=rvts2>(IOException e) {</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.printStackTrace();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>if</span><span class=rvts2>(socket != </span><span class=rvts6>null</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>try </span><span class=rvts2>{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;socket.close();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class=rvts6>catch </span><span class=rvts2>(IOException e) {</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.printStackTrace();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2></span><br><span class=rvts2></span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//</span><span class=rvts3>&#26381;&#21153;&#31471;</span><br><span class=rvts3> &nbsp; &nbsp;</span><span class=rvts5>@Test</span><br><span class=rvts5> &nbsp; &nbsp;</span><span class=rvts6>public void </span><span class=rvts2>server() &nbsp;{</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;ServerSocket ss = </span><span class=rvts6>null</span><span class=rvts2>;</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;Socket socket = </span><span class=rvts6>null</span><span class=rvts2>;</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;InputStream is = </span><span class=rvts6>null</span><span class=rvts2>;</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;ByteArrayOutputStream baos = </span><span class=rvts6>null</span><span class=rvts2>;</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>try </span><span class=rvts2>{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts4>//1.</span><span class=rvts3>&#21019;&#24314;&#26381;&#21153;&#22120;&#31471;&#30340;</span><span class=rvts4>ServerSocket</span><span class=rvts3>&#65292;&#25351;&#26126;&#33258;&#24049;&#30340;&#31471;&#21475;&#21495;</span><br><span class=rvts3> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>ss = </span><span class=rvts6>new </span><span class=rvts2>ServerSocket(</span><span class=rvts9>8899</span><span class=rvts2>);</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts4>//2.</span><span class=rvts3>&#35843;&#29992;</span><span class=rvts4>accept()</span><span class=rvts3>&#34920;&#31034;&#25509;&#25910;&#26469;&#33258;&#20110;&#23458;&#25143;&#31471;&#30340;</span><span class=rvts4>socket</span><br><span class=rvts4> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>socket = ss.accept();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts4>//3.</span><span class=rvts3>&#33719;&#21462;&#36755;&#20837;&#27969;</span><br><span class=rvts3> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>is = socket.getInputStream();</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts4>//</span><span class=rvts3>&#19981;&#24314;&#35758;&#36825;&#26679;&#20889;&#65292;&#21487;&#33021;&#20250;&#20081;&#30721;</span><br><span class=rvts4>// &nbsp; &nbsp; &nbsp; &nbsp;byte[] buffer = new byte[1024];</span><br><span class=rvts4>// &nbsp; &nbsp; &nbsp; &nbsp;int len;</span><br><span class=rvts4>// &nbsp; &nbsp; &nbsp; &nbsp;while((len = is.read(buffer)) != -1){</span><br><span class=rvts4>// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;String str = new String(buffer,0,len);</span><br><span class=rvts4>// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;System.out.print(str);</span><br><span class=rvts4>// &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts4> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//4.</span><span class=rvts3>&#35835;&#21462;&#36755;&#20837;&#27969;&#20013;&#30340;&#25968;&#25454;</span><br><span class=rvts3> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>baos = </span><span class=rvts6>new </span><span class=rvts2>ByteArrayOutputStream();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>byte</span><span class=rvts2>[] buffer = </span><span class=rvts6>new byte</span><span class=rvts2>[</span><span class=rvts9>5</span><span class=rvts2>];</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>int </span><span class=rvts2>len;</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>while</span><span class=rvts2>((len = is.read(buffer)) != -</span><span class=rvts9>1</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;baos.write(buffer,</span><span class=rvts9>0</span><span class=rvts2>,len);</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;System.</span><span class=rvts11>out</span><span class=rvts2>.println(baos.toString());</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;System.</span><span class=rvts11>out</span><span class=rvts2>.println(</span><span class=rvts8>"</span><span class=rvts10>&#25910;&#21040;&#20102;&#26469;&#33258;&#20110;&#65306;</span><span class=rvts8>" </span><span class=rvts2>+ socket.getInetAddress().getHostAddress() + </span><span class=rvts8>"</span><span class=rvts10>&#30340;&#25968;&#25454;</span><span class=rvts8>"</span><span class=rvts2>);</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class=rvts6>catch </span><span class=rvts2>(IOException e) {</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.printStackTrace();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class=rvts6>finally </span><span class=rvts2>{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>if</span><span class=rvts2>(baos != </span><span class=rvts6>null</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts4>//5.</span><span class=rvts3>&#20851;&#38381;&#36164;&#28304;</span><br><span class=rvts3> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>try </span><span class=rvts2>{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;baos.close();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class=rvts6>catch </span><span class=rvts2>(IOException e) {</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.printStackTrace();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>if</span><span class=rvts2>(is != </span><span class=rvts6>null</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>try </span><span class=rvts2>{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is.close();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class=rvts6>catch </span><span class=rvts2>(IOException e) {</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.printStackTrace();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>if</span><span class=rvts2>(socket != </span><span class=rvts6>null</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>try </span><span class=rvts2>{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;socket.close();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class=rvts6>catch </span><span class=rvts2>(IOException e) {</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.printStackTrace();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>if</span><span class=rvts2>(ss != </span><span class=rvts6>null</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts6>try </span><span class=rvts2>{</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ss.close();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class=rvts6>catch </span><span class=rvts2>(IOException e) {</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.printStackTrace();</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;}</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp;}</span></p>
<p><span class=rvts2><br></span></p>
<p><span class=rvts2>&#20195;&#30721;&#31034;&#20363;2&#65306;</span><span class=rvts3>&#23458;&#25143;&#31471;&#21457;&#36865;&#25991;&#20214;&#32473;&#26381;&#21153;&#31471;&#65292;&#26381;&#21153;&#31471;&#23558;&#25991;&#20214;&#20445;&#23384;&#22312;&#26412;&#22320;&#12290;</span></p>
<p class=rvps2><span class=rvts4>/*</span><br><span class=rvts3>&#36825;&#37324;&#28041;&#21450;&#21040;&#30340;&#24322;&#24120;&#65292;&#24212;&#35813;&#20351;&#29992;</span><span class=rvts4>try-catch-finally</span><span class=rvts3>&#22788;&#29702;</span><br><span class=rvts4> */</span><br><span class=rvts5>@Test</span><br><span class=rvts6>public void </span><span class=rvts2>client() </span><span class=rvts6>throws </span><span class=rvts2>IOException {</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//1.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>Socket socket = </span><span class=rvts6>new </span><span class=rvts2>Socket(InetAddress.</span><span class=rvts7>getByName</span><span class=rvts2>(</span><span class=rvts8>"127.0.0.1"</span><span class=rvts2>),</span><span class=rvts9>9090</span><span class=rvts2>);</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//2.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>OutputStream os = socket.getOutputStream();</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//3.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>FileInputStream fis = </span><span class=rvts6>new </span><span class=rvts2>FileInputStream(</span><span class=rvts6>new </span><span class=rvts2>File(</span><span class=rvts8>"beauty.jpg"</span><span class=rvts2>));</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//4.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts6>byte</span><span class=rvts2>[] buffer = </span><span class=rvts6>new byte</span><span class=rvts2>[</span><span class=rvts9>1024</span><span class=rvts2>];</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>int </span><span class=rvts2>len;</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>while</span><span class=rvts2>((len = fis.read(buffer)) != -</span><span class=rvts9>1</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;os.write(buffer,</span><span class=rvts9>0</span><span class=rvts2>,len);</span><br><span class=rvts2> &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//5.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>fis.close();</span><br><span class=rvts2> &nbsp; &nbsp;os.close();</span><br><span class=rvts2> &nbsp; &nbsp;socket.close();</span><br><span class=rvts2>}</span><br><span class=rvts2></span><br><span class=rvts4>/*</span><br><span class=rvts3>&#36825;&#37324;&#28041;&#21450;&#21040;&#30340;&#24322;&#24120;&#65292;&#24212;&#35813;&#20351;&#29992;</span><span class=rvts4>try-catch-finally</span><span class=rvts3>&#22788;&#29702;</span><br><span class=rvts4> */</span><br><span class=rvts5>@Test</span><br><span class=rvts6>public void </span><span class=rvts2>server() </span><span class=rvts6>throws </span><span class=rvts2>IOException {</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//1.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>ServerSocket ss = </span><span class=rvts6>new </span><span class=rvts2>ServerSocket(</span><span class=rvts9>9090</span><span class=rvts2>);</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//2.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>Socket socket = ss.accept();</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//3.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>InputStream is = socket.getInputStream();</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//4.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>FileOutputStream fos = </span><span class=rvts6>new </span><span class=rvts2>FileOutputStream(</span><span class=rvts6>new </span><span class=rvts2>File(</span><span class=rvts8>"beauty1.jpg"</span><span class=rvts2>));</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//5.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts6>byte</span><span class=rvts2>[] buffer = </span><span class=rvts6>new byte</span><span class=rvts2>[</span><span class=rvts9>1024</span><span class=rvts2>];</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>int </span><span class=rvts2>len;</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>while</span><span class=rvts2>((len = is.read(buffer)) != -</span><span class=rvts9>1</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;fos.write(buffer,</span><span class=rvts9>0</span><span class=rvts2>,len);</span><br><span class=rvts2> &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//6.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>fos.close();</span><br><span class=rvts2> &nbsp; &nbsp;is.close();</span><br><span class=rvts2> &nbsp; &nbsp;socket.close();</span><br><span class=rvts2> &nbsp; &nbsp;ss.close();</span><br><span class=rvts2></span><br><span class=rvts2>}</span></p>
<p><span class=rvts2><br></span></p>
<p><span class=rvts2>&#20195;&#30721;&#31034;&#20363;3&#65306;</span><span class=rvts3>&#20174;&#23458;&#25143;&#31471;&#21457;&#36865;&#25991;&#20214;&#32473;&#26381;&#21153;&#31471;&#65292;&#26381;&#21153;&#31471;&#20445;&#23384;&#21040;&#26412;&#22320;&#12290;&#24182;&#36820;&#22238;</span><span class=rvts4>&#8220;</span><span class=rvts3>&#21457;&#36865;&#25104;&#21151;</span><span class=rvts4>&#8221;</span><span class=rvts3>&#32473;&#23458;&#25143;&#31471;&#12290;&#24182;&#20851;&#38381;&#30456;&#24212;&#30340;&#36830;&#25509;&#12290;</span></p>
<p><span class=rvts2><br></span></p>
<p class=rvps2><span class=rvts4>/*</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts3>&#36825;&#37324;&#28041;&#21450;&#21040;&#30340;&#24322;&#24120;&#65292;&#24212;&#35813;&#20351;&#29992;</span><span class=rvts4>try-catch-finally</span><span class=rvts3>&#22788;&#29702;</span><br><span class=rvts4> &nbsp; &nbsp; */</span><br><span class=rvts5>@Test</span><br><span class=rvts6>public void </span><span class=rvts2>client() </span><span class=rvts6>throws </span><span class=rvts2>IOException {</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//1.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>Socket socket = </span><span class=rvts6>new </span><span class=rvts2>Socket(InetAddress.</span><span class=rvts7>getByName</span><span class=rvts2>(</span><span class=rvts8>"127.0.0.1"</span><span class=rvts2>),</span><span class=rvts9>9090</span><span class=rvts2>);</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//2.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>OutputStream os = socket.getOutputStream();</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//3.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>FileInputStream fis = </span><span class=rvts6>new </span><span class=rvts2>FileInputStream(</span><span class=rvts6>new </span><span class=rvts2>File(</span><span class=rvts8>"beauty.jpg"</span><span class=rvts2>));</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//4.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts6>byte</span><span class=rvts2>[] buffer = </span><span class=rvts6>new byte</span><span class=rvts2>[</span><span class=rvts9>1024</span><span class=rvts2>];</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>int </span><span class=rvts2>len;</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>while</span><span class=rvts2>((len = fis.read(buffer)) != -</span><span class=rvts9>1</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;os.write(buffer,</span><span class=rvts9>0</span><span class=rvts2>,len);</span><br><span class=rvts2> &nbsp; &nbsp;}</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//</span><span class=rvts3>&#20851;&#38381;&#25968;&#25454;&#30340;&#36755;&#20986;</span><br><span class=rvts3> &nbsp; &nbsp;</span><span class=rvts12>socket.shutdownOutput();</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//5.</span><span class=rvts3>&#25509;&#25910;&#26469;&#33258;&#20110;&#26381;&#21153;&#22120;&#31471;&#30340;&#25968;&#25454;&#65292;&#24182;&#26174;&#31034;&#21040;&#25511;&#21046;&#21488;&#19978;</span><br><span class=rvts3> &nbsp; &nbsp;</span><span class=rvts2>InputStream is = socket.getInputStream();</span><br><span class=rvts2> &nbsp; &nbsp;ByteArrayOutputStream baos = </span><span class=rvts6>new </span><span class=rvts2>ByteArrayOutputStream();</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>byte</span><span class=rvts2>[] bufferr = </span><span class=rvts6>new byte</span><span class=rvts2>[</span><span class=rvts9>20</span><span class=rvts2>];</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>int </span><span class=rvts2>len1;</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>while</span><span class=rvts2>((len1 = is.read(buffer)) != -</span><span class=rvts9>1</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;baos.write(buffer,</span><span class=rvts9>0</span><span class=rvts2>,len1);</span><br><span class=rvts2> &nbsp; &nbsp;}</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp;System.</span><span class=rvts11>out</span><span class=rvts2>.println(baos.toString());</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//6.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>fis.close();</span><br><span class=rvts2> &nbsp; &nbsp;os.close();</span><br><span class=rvts2> &nbsp; &nbsp;socket.close();</span><br><span class=rvts2> &nbsp; &nbsp;baos.close();</span><br><span class=rvts2>}</span><br><span class=rvts2></span><br><span class=rvts4>/*</span><br><span class=rvts3>&#36825;&#37324;&#28041;&#21450;&#21040;&#30340;&#24322;&#24120;&#65292;&#24212;&#35813;&#20351;&#29992;</span><span class=rvts4>try-catch-finally</span><span class=rvts3>&#22788;&#29702;</span><br><span class=rvts4> */</span><br><span class=rvts5>@Test</span><br><span class=rvts6>public void </span><span class=rvts2>server() </span><span class=rvts6>throws </span><span class=rvts2>IOException {</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//1.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>ServerSocket ss = </span><span class=rvts6>new </span><span class=rvts2>ServerSocket(</span><span class=rvts9>9090</span><span class=rvts2>);</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//2.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>Socket socket = ss.accept();</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//3.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>InputStream is = socket.getInputStream();</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//4.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>FileOutputStream fos = </span><span class=rvts6>new </span><span class=rvts2>FileOutputStream(</span><span class=rvts6>new </span><span class=rvts2>File(</span><span class=rvts8>"beauty2.jpg"</span><span class=rvts2>));</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//5.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts6>byte</span><span class=rvts2>[] buffer = </span><span class=rvts6>new byte</span><span class=rvts2>[</span><span class=rvts9>1024</span><span class=rvts2>];</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>int </span><span class=rvts2>len;</span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts6>while</span><span class=rvts2>((len = is.read(buffer)) != -</span><span class=rvts9>1</span><span class=rvts2>){</span><br><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;fos.write(buffer,</span><span class=rvts9>0</span><span class=rvts2>,len);</span><br><span class=rvts2> &nbsp; &nbsp;}</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp;System.</span><span class=rvts11>out</span><span class=rvts2>.println(</span><span class=rvts8>"</span><span class=rvts10>&#22270;&#29255;&#20256;&#36755;&#23436;&#25104;</span><span class=rvts8>"</span><span class=rvts2>);</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//6.</span><span class=rvts3>&#26381;&#21153;&#22120;&#31471;&#32473;&#20104;&#23458;&#25143;&#31471;&#21453;&#39304;</span><br><span class=rvts3> &nbsp; &nbsp;</span><span class=rvts2>OutputStream os = socket.getOutputStream();</span><br><span class=rvts2> &nbsp; &nbsp;os.write(</span><span class=rvts8>"</span><span class=rvts10>&#20320;&#22909;&#65292;&#32654;&#22899;&#65292;&#29031;&#29255;&#25105;&#24050;&#25910;&#21040;&#65292;&#38750;&#24120;&#28418;&#20142;&#65281;</span><span class=rvts8>"</span><span class=rvts2>.getBytes());</span><br><span class=rvts2></span><br><span class=rvts2> &nbsp; &nbsp;</span><span class=rvts4>//7.</span><br><span class=rvts4> &nbsp; &nbsp;</span><span class=rvts2>fos.close();</span><br><span class=rvts2> &nbsp; &nbsp;is.close();</span><br><span class=rvts2> &nbsp; &nbsp;socket.close();</span><br><span class=rvts2> &nbsp; &nbsp;ss.close();</span><br><span class=rvts2> &nbsp; &nbsp;os.close();</span><br><span class=rvts2></span><br><span class=rvts2>}</span></p>
</body></html>
