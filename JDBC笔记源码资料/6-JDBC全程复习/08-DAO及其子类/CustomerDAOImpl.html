<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>CustomerDAOImpl.html</title>
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
  margin: 15px 23px 15px 23px;
  background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 9pt;
 font-family: 'ו';
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
a.rvts1, span.rvts1 /* Hyperlink */
{
 color: #0000ff;
 text-decoration: underline;
}
span.rvts2
{
 font-size: 14pt;
 font-family: 'Consolas';
 color: #000000;
}
span.rvts3
{
 font-size: 14pt;
 font-family: 'Consolas';
}
span.rvts4
{
 font-size: 14pt;
 font-family: 'Consolas';
 color: #6a3e3e;
}
span.rvts5
{
 font-size: 14pt;
 font-family: 'Consolas';
 font-weight: bold;
 color: #7f0055;
}
span.rvts6
{
 font-size: 14pt;
 font-family: 'Consolas';
 color: #2a00ff;
}
span.rvts7
{
 font-size: 14pt;
 font-family: 'Consolas';
 color: #646464;
}
span.rvts8
{
 font-size: 12pt;
 font-weight: bold;
 color: #000000;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
--></style>
</head>
<body>
<p class=rvps1><span class=rvts8>CustomerDAOImpl</span></p>
<p><span class=rvts8><br></span></p>
<p><span class=rvts5>public</span><span class=rvts2> </span><span class=rvts5>class</span><span class=rvts2> CustomerDAOImpl </span><span class=rvts5>extends</span><span class=rvts2> BaseDAO&lt;Customer&gt; </span><span class=rvts5>implements</span><span class=rvts2> CustomerDAO{</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p><span class=rvts2><br></span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts7>@Override</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>public</span><span class=rvts2> </span><span class=rvts5>void</span><span class=rvts2> insert(Connection </span><span class=rvts4>conn</span><span class=rvts2>, Customer </span><span class=rvts4>cust</span><span class=rvts2>) {</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>String </span><span class=rvts4>sql</span><span class=rvts2> = </span><span class=rvts6>"insert into customers(name,email,birth)values(?,?,?)"</span><span class=rvts2>;</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>update(</span><span class=rvts4>conn</span><span class=rvts2>, </span><span class=rvts4>sql</span><span class=rvts2>,</span><span class=rvts4>cust</span><span class=rvts2>.getName(),</span><span class=rvts4>cust</span><span class=rvts2>.getEmail(),</span><span class=rvts4>cust</span><span class=rvts2>.getBirth());</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>}</span></p>
<p><span class=rvts3><br></span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts7>@Override</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>public</span><span class=rvts2> </span><span class=rvts5>void</span><span class=rvts2> deleteById(Connection </span><span class=rvts4>conn</span><span class=rvts2>, </span><span class=rvts5>int</span><span class=rvts2> </span><span class=rvts4>id</span><span class=rvts2>) {</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>String </span><span class=rvts4>sql</span><span class=rvts2> = </span><span class=rvts6>"delete from customers where id = ?"</span><span class=rvts2>;</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>update(</span><span class=rvts4>conn</span><span class=rvts2>, </span><span class=rvts4>sql</span><span class=rvts2>, </span><span class=rvts4>id</span><span class=rvts2>);</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>}</span></p>
<p><span class=rvts3><br></span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts7>@Override</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>public</span><span class=rvts2> </span><span class=rvts5>void</span><span class=rvts2> update(Connection </span><span class=rvts4>conn</span><span class=rvts2>, Customer </span><span class=rvts4>cust</span><span class=rvts2>) {</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>String </span><span class=rvts4>sql</span><span class=rvts2> = </span><span class=rvts6>"update customers set name = ?,email = ?,birth = ? where id = ?"</span><span class=rvts2>;</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>update(</span><span class=rvts4>conn</span><span class=rvts2>, </span><span class=rvts4>sql</span><span class=rvts2>,</span><span class=rvts4>cust</span><span class=rvts2>.getName(),</span><span class=rvts4>cust</span><span class=rvts2>.getEmail(),</span><span class=rvts4>cust</span><span class=rvts2>.getBirth(),</span><span class=rvts4>cust</span><span class=rvts2>.getId());</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>}</span></p>
<p><span class=rvts3><br></span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts7>@Override</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>public</span><span class=rvts2> Customer getCustomerById(Connection </span><span class=rvts4>conn</span><span class=rvts2>, </span><span class=rvts5>int</span><span class=rvts2> </span><span class=rvts4>id</span><span class=rvts2>) {</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>String </span><span class=rvts4>sql</span><span class=rvts2> = </span><span class=rvts6>"select id,name,email,birth from customers where id = ?"</span><span class=rvts2>;</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>Customer </span><span class=rvts4>customer</span><span class=rvts2> = getInstance(</span><span class=rvts4>conn</span><span class=rvts2>, </span><span class=rvts4>sql</span><span class=rvts2>,</span><span class=rvts4>id</span><span class=rvts2>);</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>return</span><span class=rvts2> </span><span class=rvts4>customer</span><span class=rvts2>;</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>}</span></p>
<p><span class=rvts3><br></span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts7>@Override</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>public</span><span class=rvts2> List&lt;Customer&gt; getAll(Connection </span><span class=rvts4>conn</span><span class=rvts2>) {</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>String </span><span class=rvts4>sql</span><span class=rvts2> = </span><span class=rvts6>"select id,name,email,birth from customers"</span><span class=rvts2>;</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>List&lt;Customer&gt; </span><span class=rvts4>list</span><span class=rvts2> = getForList(</span><span class=rvts4>conn</span><span class=rvts2>, </span><span class=rvts4>sql</span><span class=rvts2>);</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>return</span><span class=rvts2> </span><span class=rvts4>list</span><span class=rvts2>;</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>}</span></p>
<p><span class=rvts3><br></span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts7>@Override</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>public</span><span class=rvts2> Long getCount(Connection </span><span class=rvts4>conn</span><span class=rvts2>) {</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>String </span><span class=rvts4>sql</span><span class=rvts2> = </span><span class=rvts6>"select count(*) from customers"</span><span class=rvts2>;</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>return</span><span class=rvts2> getValue(</span><span class=rvts4>conn</span><span class=rvts2>, </span><span class=rvts4>sql</span><span class=rvts2>);</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>}</span></p>
<p><span class=rvts3><br></span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts7>@Override</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>public</span><span class=rvts2> Date getMaxBirth(Connection </span><span class=rvts4>conn</span><span class=rvts2>) {</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>String </span><span class=rvts4>sql</span><span class=rvts2> = </span><span class=rvts6>"select max(birth) from customers"</span><span class=rvts2>;</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts5>return</span><span class=rvts2> getValue(</span><span class=rvts4>conn</span><span class=rvts2>, </span><span class=rvts4>sql</span><span class=rvts2>);</span></p>
<p><span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class=rvts2>}</span></p>
<p><span class=rvts3><br></span></p>
<p><span class=rvts2>}</span></p>
</body></html>
